<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bruno's Calculator s Firebase Auth</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4CAF50">

  <!-- Security Headers - OWASP Recommendations -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' https://www.gstatic.com https://cdnjs.cloudflare.com https://www.google.com https://apis.google.com;
    style-src 'self' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
    img-src 'self' https: data: blob:;
    connect-src 'self'
      https://*.firebaseio.com
      https://*.googleapis.com
      https://firestore.googleapis.com
      https://identitytoolkit.googleapis.com
      https://securetoken.googleapis.com
      https://www.google.com
      https://www.gstatic.com
      https://cdnjs.cloudflare.com;
    frame-src https://www.google.com https://recaptcha.google.com https://*.firebaseapp.com;
    object-src 'none';
    base-uri 'self';
    form-action 'self';
    upgrade-insecure-requests;
  ">

  <!-- OWASP Secure Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta name="referrer" content="no-referrer">

  <!-- POZNÁMKA: Nasledujúce CSP direktívy a security headers MUSIA byť nastavené cez HTTP server (nefungujú v meta tag): -->
  <!-- CSP frame-ancestors 'none';  - prevencia clickjacking (ignorované v meta, len HTTP header!) -->
  <!-- X-Frame-Options: DENY  - legacy fallback pre staré browsery -->
  <!-- Strict-Transport-Security: max-age=31536000; includeSubDomains; preload  - HTTPS only -->
  <!-- Permissions-Policy: geolocation=(), camera=(), microphone=(), payment=(), usb=()  - feature policy -->

  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap&subset=latin-ext" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">

  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"
          integrity="sha384-iseUZMjd63Pz0jb9In72RWfpJu8HrPFrK7K99+pPQmcDg2CgHIo2NdxWhrhejqRo"
          crossorigin="anonymous"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"
          integrity="sha384-44ncECNgnaHP6ESasAOFgMcbh9SrKGi2zK28Fc5zVLneRWT6jJ4Q9vnN49UsuyQ/"
          crossorigin="anonymous"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"
          integrity="sha384-+/4lqMnmLqwbdHXshvGDmBTeWlNoPRdjXi4ZsiBj10EhQXaTBe3RF5JZktdSjug6"
          crossorigin="anonymous"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-check-compat.js"
          integrity="sha384-HTm9DHQcJ0avSI5BWVmeKtm3+YULHbl/wgtLQaMGgYEZLQ8cINY+UF+ZsliUaBvK"
          crossorigin="anonymous"></script>

  <!-- jsPDF 2.5.2+ with CVE-2020-7691 fix -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.2/dist/jspdf.umd.min.js"
          integrity="sha384-VPuqCa+j0FFi1rAH1dLOBhHU+fGfSYbdg+hd2p7iLG5rnPr6GvkdGPPNpXFj5QUj"
          crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.3/dist/jspdf.plugin.autotable.min.js"
          integrity="sha384-RPXv2Ny9Vb6BsL02+yfCDNvhLwdPXBTu+TjK7vqYJqTX5RaHzOcOz4L2IOwwU7iQ"
          crossorigin="anonymous"></script>
</head>
<body>
  <div id="auth-container" class="hidden">
    <h1>Prihlásenie / Registrácia</h1>
    <div id="auth-message">Žiadny používateľ nie je prihlásený.</div>
    <div id="auth-forms">
      <h2>Registrácia</h2>
      <input type="email" id="registerEmail" placeholder="Email">
      <input type="password" id="registerPassword" placeholder="Heslo">
      <button id="registerBtn">Registrovať</button>
      <h2>Prihlásenie</h2>
      <input type="email" id="loginEmail" placeholder="Email">
      <input type="password" id="loginPassword" placeholder="Heslo">
      <button id="loginBtn">Prihlásiť sa</button>
      <a id="forgot-password-link">Zabudli ste heslo?</a>
    </div>
  </div>
  <div id="calculator-container" class="container hidden">
    <div class="autor-info">Vytvoril Bruno</div>
    <h1 id="mainTitle">Šťastné a veselé vianoce</h1>
    <h2 id="welcomeMessage"></h2>
    <div class="settings">
        <div>
            <label for="monthSelect">Mesiac: </label>
            <select id="monthSelect">
                <option value="0">Január</option>
                <option value="1">Február</option>
                <option value="2">Marec</option>
                <option value="3">Apríl</option>
                <option value="4">Máj</option>
                <option value="5">Jún</option>
                <option value="6">Júl</option>
                <option value="7">August</option>
                <option value="8">September</option>
                <option value="9">Október</option>
                <option value="10">November</option>
                <option value="11">December</option>
            </select>
        </div>

        <details class="collapsible-settings">
            <summary>Ďalšie nastavenia</summary>
            <div class="collapsible-content">
                <div>
                    <label for="employeeNameInput">Meno pracovníka: </label>
                    <input type="text" id="employeeNameInput" placeholder="Zadajte meno pracovníka">
                </div>
                <div>
                    <label for="hourlyWageInput">Hodinová mzda (€): </label>
                    <input type="number" id="hourlyWageInput" value="10" min="0" step="0.1">
                </div>
                <div>
                    <label for="taxRateInput">Daňové percento (%): </label>
                    <input type="number" id="taxRateInput" value="2" min="0" step="0.1">
                </div>
                <div>
                    <label for="yearSelect">Rok: </label>
                    <select id="yearSelect"></select>
                </div>
                <div>
                    <label for="decimalPlacesSelect">Počet desatinných miest: </label>
                    <select id="decimalPlacesSelect">
                        <option value="1">1</option>
                        <option value="2">2</option>
                    </select>
                </div>
            </div>
        </details>

        <button id="toggleDarkModeBtn" class="btn highlight">Prepínať tmavý režim</button>
    </div>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Deň</th>
            <th>Príchod</th>
            <th>Odchod</th>
            <th>Prestávka</th>
            <th>Odpracované</th>
            <th>Hrubá Mzda (€)</th>
            <th>Čistá Mzda (€)</th>
            <th class="th-note">Poznámka</th>
            <th>Akcia</th>
          </tr>
        </thead>
        <tbody id="workDays"></tbody>
      </table>
    </div>
    <div id="totalSalary"></div>
    <div id="dataSizeContainer">
      <div id="dataSizeText">Lokálne úložisko: ~0.00 KB / 4096 KB</div>
      <div id="dataSizeBar"><div id="dataSizeFill"></div></div>
    </div>
    <div class="btn-container">
      <button id="resetAllBtn" class="btn reset-btn">Resetovať všetko</button>
      <button id="exportPDFBtn" class="btn export-btn">Exportovať do PDF</button>
      <button id="sendPDFBtn" class="btn export-btn">Odoslať</button>
      <button id="restoreBackupBtn" class="btn restore-btn">Obnoviť zálohu</button>
      <button id="createBackupBtn" class="btn backup-btn">Vytvoriť zálohu</button>
      <button id="logout-btn" class="btn reset-btn">Odhlásiť sa</button>
    </div>
  </div>
  <div id="saveNotification"></div>

  <script src="app.js"></script>
</body>
</html>
